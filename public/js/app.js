!function(t){t.fn.suggestionBox=function(n){function e(t){T=j.find("li:eq("+t+") a").attr("href"),j.find("li:eq("+t+")").addClass("selected")}function i(t){j.find("li:eq("+t+")").removeClass("selected")}function r(){T="#",P=-1,j.find("li").removeClass("selected")}function s(){var t=j.find("li").length;P===t-1?(i(P),r()):(i(P),P++,e(P))}function o(){P>0?(i(P),P--,e(P)):-1==P?(i(P),P=j.find("li").length-1,e(P)):(i(0),r())}function u(){j.css("display","none"),window.location=T}function a(n){N=x.val(),t.ajax({url:n,data:$,dataType:"json",success:function(t){var n=!0,i=P;q.results&&t.results&&(n=JSON.stringify(q.results[P])!==JSON.stringify(t.results[P])),w(t),m(),i>-1&&x.val()===N&&!n&&(P=i,e(P)),O.ajaxSuccess(t)},error:function(t){O.ajaxError(t)}})}function f(n){var e=t(n.target).parent("li");return e.parent().children().index(e)}function c(){var t=l(x,"border-bottom-width")+l(x,"border-top-width"),n=l(x,"padding-bottom")+l(x,"padding-top");j.css({position:"absolute",left:x.offset().left+O.leftOffset,top:x.offset().top+(x.height()+t+n+O.topOffset)})}function l(t,n){return parseInt(t.css(n).replace("px",""))}function d(){O.fadeOut?j.fadeOut():j.css("display","none"),r()}function h(){O.fadeIn?j.fadeIn():j.css("display","block")}function g(){var t=p()+O.widthAdjustment;"auto"==O.menuWidth?j.css({"min-width":t}):"constrain"==O.menuWidth&&j.css({width:t})}function p(){return x.width()+l(x,"border-left-width")+l(x,"border-right-width")+l(x,"padding-left")+l(x,"padding-right")}function v(n){var e='<div id="suggestion-header">'+O.heading+'</div> <ul id="suggestion-box-list">';return t.each(n.results,function(n,i){if(!i.suggestion||!i.url)return!1;D=!0;var r="";return i.attr&&t.each(i.attr,function(t,n){for(var e=Object.keys(n),i=0;i<e.length;i++)r+=e[i]+'="'+n[e[i]]+'" '}),e+='<li><a href="'+i.url+'" '+r+">"+i.suggestion+"</a></li>",n!==O.results-1&&void 0}),e+="</ul>"}function m(){r(),D=!1;var t=O.filter?S(x.val()):q;if(t&&t.results)var n=v(t);K?D?(j.html(n),g(),h()):O.showNoSuggestionsMessage&&x.val().length>0?(g(),h(),j.html('<div id="no-suggestions">'+O.noSuggestionsMessage+"</div>")):d():d()}function w(n){q=n?n instanceof Object?n:t.parseJSON(n):{}}function y(n){t.ajax({url:n,dataType:"json",success:function(t){w(t)},error:function(t){}})}function S(n){var e;if(filterPattern=O.filterPattern.replace("{INPUT}",n),!n)return{};if(q&&q.results){var i=new RegExp(filterPattern,"i");e=t.grep(q.results,function(t){return i.test(t.suggestion)})}O.sort&&e.sort(O.sort);var r=JSON.stringify({results:e});return t.parseJSON(r)}var x=this,O=t.extend({topOffset:0,leftOffset:0,widthAdjustment:0,delay:400,heading:"Suggestions",results:10,fadeIn:!0,fadeOut:!1,menuWidth:"auto",showNoSuggestionsMessage:!1,noSuggestionsMessage:"No Suggestions Found",filter:!1,filterPattern:"({INPUT})",ajaxError:function(t){},ajaxSuccess:function(t){},enterKeyAction:function(){u()},paramName:"search"},n);t("body").append('<div id="suggestion-box"></div>'),x.attr("autocomplete","off");var j=t("#suggestion-box");c();var N,b=13,A=38,k=40,I=27,P=-1,T="#",J=!1,E=null,D=!1,K=!1,$={},q={};return j.on({mousemove:function(t){"A"===t.target.nodeName&&(i(P),P=f(t),e(P),J=!0)},mouseout:function(t){"A"===t.target.nodeName&&(J=!1,i(P),r())},click:function(t){"A"===t.target.nodeName&&j.css("display","none")}}),x.on({blur:function(){K=!1,J||d()},focus:function(){K=!0,t(this).val()&&m(q)},keyup:function(t){t.which!==A&&t.which!==k&&t.which!==I&&t.which!==b&&(O.url&&(r(),E&&clearTimeout(E)),O.url&&($[O.paramName]=x.val(),E=setTimeout(function(){a(O.url)},O.delay)),O.filter&&m())},keydown:function(t){"none"!==j.css("display")&&(t.which==k&&(t.preventDefault(),s()),t.which==A&&(t.preventDefault(),o()),t.which===b&&P>-1&&(t.preventDefault(),O.enterKeyAction()),t.which==I&&(t.preventDefault(),d()))},paste:function(){setTimeout(function(){x.keyup()},200)}}),t(window).resize(function(){c()}),{getSuggestions:function(t){return a(t),this},addSuggestions:function(t){return w(t),this},loadSuggestions:function(t){return y(t),this},getJson:function(){return JSON.stringify(q)},moveUp:function(){return o(),this},moveDown:function(){return s(),this},selectedUrl:function(){return T},selectedSuggestion:function(){return j.find("li:eq("+P+")").text()},position:function(){return P},select:function(t){return i(P),P=t,e(t),this},reset:function(){return i(P),r(),this},show:function(){return x.focus(),m(),this},hide:function(){return d(),this},url:function(t){return O.url=t,this},fadeIn:function(t){return O.fadeIn=t,this},fadeOut:function(t){return O.fadeOut=t,this},delay:function(t){return O.delay=t,this},heading:function(t){return O.heading=t,this},results:function(t){return O.results=t,this},ajaxError:function(t){return O.ajaxError=t,this},ajaxSuccess:function(t){return O.ajaxSuccess=t,this},filter:function(t){return O.filter=t,this},filterPattern:function(t){return O.filterPattern=t,this},sort:function(t){return O.sort=t,this},enterKeyAction:function(t){return O.enterKeyAction=t,this},destroy:function(){return x.unbind(this),j.remove(),null}}}}(jQuery),$(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$('[data-toggle="tooltip"]').tooltip(),$("#search").suggestionBox({filter:!1,widthAdjustment:-8,leftOffset:4,topOffset:0,menuWidth:"constrain",heading:"Gợi ý tìm kiếm",results:6,delay:200,paramName:"s",url:"/livesearch"}).loadSuggestions("/livesearch")});